<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test API Phong</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .btn-success { background-color: #28a745; }
        .btn-warning { background-color: #ffc107; color: #212529; }
        .btn-danger { background-color: #dc3545; }
        .btn-info { background-color: #17a2b8; }
        
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        pre {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            max-height: 400px;
            overflow-y: auto;
        }
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .image-preview {
            max-width: 200px;
            max-height: 200px;
            margin-top: 10px;
            border-radius: 5px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè® Test API Phong - H·ªá th·ªëng Qu·∫£n l√Ω Kh√°ch s·∫°n</h1>
        
        <div class="grid">
            <!-- X√ìA ho·∫∑c ·∫®N form t·∫°o ph√≤ng c∆° b·∫£n -->
            <!--<div>
                <h2>1. T·∫°o ph√≤ng c∆° b·∫£n</h2>
                <form id="createBasicForm">
                    <div class="form-group">
                        <label for="tenPhong">T√™n Ph√≤ng:</label>
                        <input type="text" id="tenPhong" name="tenPhong" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="donVi">ƒê∆°n V·ªã:</label>
                        <select id="donVi" name="donVi" class="donvi-select" required onchange="onDonViChange('donVi', 'idTang')">
                            <option value="">-- Ch·ªçn ƒë∆°n v·ªã --</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="idTang">ID T·∫ßng:</label>
                        <select id="idTang" name="idTang" required>
                            <option value="">-- Ch·ªçn t·∫ßng --</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="idLoaiPhong">ID Lo·∫°i Ph√≤ng:</label>
                        <input type="number" id="idLoaiPhong" name="idLoaiPhong" value="1" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="trangThai">Tr·∫°ng Th√°i:</label>
                        <select id="trangThai" name="trangThai" required>
                            <option value="Tr·ªëng">Tr·ªëng</option>
                            <option value="ƒêang s·ª≠ d·ª•ng">ƒêang s·ª≠ d·ª•ng</option>
                            <option value="B·∫£o tr√¨">B·∫£o tr√¨</option>
                            <option value="ƒê√£ ƒë·∫∑t">ƒê√£ ƒë·∫∑t</option>
                        </select>
                    </div>
                    
                    <button type="submit" class="btn-success">T·∫°o Ph√≤ng</button>
                </form>
                <div id="createBasicResult" class="result"></div>
            </div>-->
            <div style="grid-column: 1 / span 2;">
                <h2>1. T·∫°o ph√≤ng v·ªõi ·∫£nh</h2>
                <form id="createWithImageForm" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="tenPhong2">T√™n Ph√≤ng:</label>
                        <input type="text" id="tenPhong2" name="tenPhong2" required>
                    </div>
                    <div class="form-group">
                        <label for="donVi2">ƒê∆°n V·ªã:</label>
                        <select id="donVi2" name="donVi2" class="donvi-select" required onchange="onDonViChange('donVi2', 'idTang2')">
                            <option value="">-- Ch·ªçn ƒë∆°n v·ªã --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="idTang2">ID T·∫ßng:</label>
                        <select id="idTang2" name="idTang2" required>
                            <option value="">-- Ch·ªçn t·∫ßng --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="idLoaiPhong2">ID Lo·∫°i Ph√≤ng:</label>
                        <input type="number" id="idLoaiPhong2" name="idLoaiPhong2" value="1" required>
                    </div>
                    <div class="form-group">
                        <label for="trangThai2">Tr·∫°ng Th√°i:</label>
                        <select id="trangThai2" name="trangThai2" required>
                            <option value="Tr·ªëng">Tr·ªëng</option>
                            <option value="ƒêang s·ª≠ d·ª•ng">ƒêang s·ª≠ d·ª•ng</option>
                            <option value="B·∫£o tr√¨">B·∫£o tr√¨</option>
                            <option value="ƒê√£ ƒë·∫∑t">ƒê√£ ƒë·∫∑t</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="file">·∫¢nh Ph√≤ng:</label>
                        <input type="file" id="file" name="file" accept="image/*" required>
                        <img id="preview" class="image-preview" alt="Preview">
                    </div>
                    <button type="submit" class="btn-success">T·∫°o Ph√≤ng v·ªõi ·∫¢nh</button>
                </form>
                <div id="createWithImageResult" class="result"></div>
            </div>
        </div>
    </div>

    <div class="container">
        <h2>3. Xem th√¥ng tin ph√≤ng</h2>
        <button onclick="getAllPhong()" class="btn-info">L·∫•y t·∫•t c·∫£ ph√≤ng</button>
        <button onclick="getAllPhongDetail()" class="btn-info">L·∫•y chi ti·∫øt ph√≤ng</button>
        
        <div class="form-group">
            <label for="getById">ID Ph√≤ng:</label>
            <input type="number" id="getById" name="getById" value="1">
        </div>
        <button onclick="getPhongById()" class="btn-info">L·∫•y ph√≤ng theo ID</button>
        <button onclick="getPhongDetailById()" class="btn-info">L·∫•y chi ti·∫øt ph√≤ng theo ID</button>
        
        <div id="viewResult" class="result"></div>
    </div>

    <div class="container">
        <h2>4. C·∫≠p nh·∫≠t v√† x√≥a ph√≤ng</h2>
        <form id="updateForm">
            <div class="form-group">
                <label for="updateId">ID Ph√≤ng c·∫ßn c·∫≠p nh·∫≠t:</label>
                <input type="number" id="updateId" name="updateId" value="1" required>
            </div>
            
            <div class="form-group">
                <label for="updateTenPhong">T√™n Ph√≤ng m·ªõi:</label>
                <input type="text" id="updateTenPhong" name="updateTenPhong" required>
            </div>
            
            <div class="form-group">
                <label for="updateDonVi">ƒê∆°n V·ªã m·ªõi:</label>
                <select id="updateDonVi" name="updateDonVi" class="donvi-select" required onchange="onDonViChange('updateDonVi', 'updateIdTang')">
                    <option value="">-- Ch·ªçn ƒë∆°n v·ªã --</option>
                </select>
            </div>
            <div class="form-group">
                <label for="updateIdTang">ID T·∫ßng m·ªõi:</label>
                <select id="updateIdTang" name="updateIdTang" required>
                    <option value="">-- Ch·ªçn t·∫ßng --</option>
                </select>
            </div>
            <div class="form-group">
                <label for="updateAnhPhong">·∫¢nh ph√≤ng (ƒë∆∞·ªùng d·∫´n):</label>
                <input type="text" id="updateAnhPhong" name="updateAnhPhong" placeholder="/uploads/tenfile.jpg">
            </div>
            
            <div class="form-group">
                <label for="updateIdLoaiPhong">ID Lo·∫°i Ph√≤ng m·ªõi:</label>
                <input type="number" id="updateIdLoaiPhong" name="updateIdLoaiPhong" value="1" required>
            </div>
            
            <div class="form-group">
                <label for="updateTrangThai">Tr·∫°ng Th√°i m·ªõi:</label>
                <select id="updateTrangThai" name="updateTrangThai" required>
                    <option value="Tr·ªëng">Tr·ªëng</option>
                    <option value="ƒêang s·ª≠ d·ª•ng">ƒêang s·ª≠ d·ª•ng</option>
                    <option value="B·∫£o tr√¨">B·∫£o tr√¨</option>
                    <option value="ƒê√£ ƒë·∫∑t">ƒê√£ ƒë·∫∑t</option>
                </select>
            </div>
            
            <button type="submit" class="btn-warning">C·∫≠p nh·∫≠t Ph√≤ng</button>
        </form>
        <div id="updateResult" class="result"></div>

        <h3>X√≥a Ph√≤ng</h3>
        <div class="form-group">
            <label for="deleteId">ID Ph√≤ng c·∫ßn x√≥a:</label>
            <input type="number" id="deleteId" name="deleteId" value="1">
        </div>
        <button onclick="deletePhong()" class="btn-danger">X√≥a Ph√≤ng</button>
        <div id="deleteResult" class="result"></div>
    </div>

    <div class="container">
        <h2>5. T√¨m ki·∫øm v√† l·ªçc ph√≤ng</h2>
        <div class="grid">
            <div>
                <h3>T√¨m ki·∫øm c∆° b·∫£n</h3>
                <div class="form-group">
                    <label for="searchTen">T√¨m theo t√™n ph√≤ng:</label>
                    <input type="text" id="searchTen" name="searchTen" placeholder="P101">
                </div>
                <button onclick="searchByTen()" class="btn-info">T√¨m theo t√™n</button>

                <div class="form-group">
                    <label for="searchKeyword">T√¨m theo t·ª´ kh√≥a:</label>
                    <input type="text" id="searchKeyword" name="searchKeyword" placeholder="P">
                </div>
                <button onclick="searchByKeyword()" class="btn-info">T√¨m theo t·ª´ kh√≥a</button>

                <div class="form-group">
                    <label for="searchTrangThai">T√¨m theo tr·∫°ng th√°i:</label>
                    <select id="searchTrangThai" name="searchTrangThai">
                        <option value="Tr·ªëng">Tr·ªëng</option>
                        <option value="ƒêang s·ª≠ d·ª•ng">ƒêang s·ª≠ d·ª•ng</option>
                        <option value="B·∫£o tr√¨">B·∫£o tr√¨</option>
                        <option value="ƒê√£ ƒë·∫∑t">ƒê√£ ƒë·∫∑t</option>
                    </select>
                </div>
                <button onclick="searchByTrangThai()" class="btn-info">T√¨m theo tr·∫°ng th√°i</button>
            </div>

            <div>
                <h3>L·ªçc theo tr·∫°ng th√°i</h3>
                <button onclick="getAvailableRooms()" class="btn-success">Ph√≤ng tr·ªëng</button>
                <button onclick="getBookedRooms()" class="btn-warning">Ph√≤ng ƒë√£ ƒë·∫∑t</button>
                <button onclick="getOccupiedRooms()" class="btn-danger">Ph√≤ng ƒëang s·ª≠ d·ª•ng</button>
                <button onclick="getMaintenanceRooms()" class="btn-info">Ph√≤ng b·∫£o tr√¨</button>

                <h3>Th·ªëng k√™</h3>
                <button onclick="countAllPhong()" class="btn-info">ƒê·∫øm t·∫•t c·∫£ ph√≤ng</button>
                <button onclick="countByTrangThai()" class="btn-info">ƒê·∫øm theo tr·∫°ng th√°i</button>
            </div>
        </div>
        <div id="searchResult" class="result"></div>
    </div>

    <div class="container">
        <h2>6. Upload ·∫£nh cho ph√≤ng</h2>
        <form id="uploadImageForm" enctype="multipart/form-data">
            <div class="form-group">
                <label for="uploadPhongId">ID Ph√≤ng:</label>
                <input type="number" id="uploadPhongId" name="uploadPhongId" value="1" required>
            </div>
            
            <div class="form-group">
                <label for="uploadFile">Ch·ªçn ·∫£nh:</label>
                <input type="file" id="uploadFile" name="uploadFile" accept="image/*" required>
                <img id="uploadPreview" class="image-preview" alt="Preview">
            </div>
            
            <button type="submit" class="btn-success">Upload ·∫¢nh</button>
        </form>
        <div id="uploadResult" class="result"></div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8080/api/phong';

        // Image preview
        document.getElementById('file').addEventListener('change', function(e) {
            previewImage(e.target, 'preview');
        });

        document.getElementById('uploadFile').addEventListener('change', function(e) {
            previewImage(e.target, 'uploadPreview');
        });

        function previewImage(input, previewId) {
            const file = input.files[0];
            const preview = document.getElementById(previewId);
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                }
                reader.readAsDataURL(file);
            } else {
                preview.style.display = 'none';
            }
        }

        // Th√™m bi·∫øn l∆∞u danh s√°ch ƒë∆°n v·ªã v√† t·∫ßng
        let donViList = [];
        let tangList = [];

        // Load danh s√°ch ƒë∆°n v·ªã khi trang load
        window.addEventListener('DOMContentLoaded', function() {
            fetch('http://localhost:8080/api/donvi')
                .then(res => res.json())
                .then(data => {
                    donViList = data;
                    const donViSelects = document.querySelectorAll('.donvi-select');
                    donViSelects.forEach(select => {
                        select.innerHTML = '<option value="">-- Ch·ªçn ƒë∆°n v·ªã --</option>' +
                            donViList.map(dv => `<option value="${dv.idDvi}">${dv.tenDvi}</option>`).join('');
                    });
                });
        });

        // Khi ch·ªçn ƒë∆°n v·ªã, load danh s√°ch t·∫ßng thu·ªôc ƒë∆°n v·ªã ƒë√≥
        function onDonViChange(selectId, tangSelectId) {
            const idDvi = document.getElementById(selectId).value;
            const tangSelect = document.getElementById(tangSelectId);
            if (!idDvi) {
                tangSelect.innerHTML = '<option value="">-- Ch·ªçn t·∫ßng --</option>';
                return;
            }
            fetch(`http://localhost:8080/api/tang?donViId=${idDvi}`)
                .then(res => res.json())
                .then(data => {
                    tangList = data;
                    tangSelect.innerHTML = '<option value="">-- Ch·ªçn t·∫ßng --</option>' +
                        tangList.map(tg => `<option value="${tg.idTang}">${tg.tenTang}</option>`).join('');
                });
        }

        // 1. T·∫°o ph√≤ng c∆° b·∫£n
        document.getElementById('createBasicForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const donViId = document.getElementById('donVi').value;
            const idTang = document.getElementById('idTang').value;

            const data = {
                tenPhong: document.getElementById('tenPhong').value,
                idDvi: parseInt(donViId),
                idTang: parseInt(idTang),
                idLoaiPhong: parseInt(document.getElementById('idLoaiPhong').value),
                trangThai: document.getElementById('trangThai').value
            };
            
            fetch(API_BASE, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(data => {
                showResult('createBasicResult', 'Th√†nh c√¥ng!', data, 'success');
                document.getElementById('createBasicForm').reset();
                document.getElementById('donVi').value = '';
                document.getElementById('idTang').innerHTML = '<option value="">-- Ch·ªçn t·∫ßng --</option>';
                document.getElementById('idLoaiPhong').value = '1';
            })
            .catch(error => showResult('createBasicResult', 'L·ªói!', error.message, 'error'));
        });

        // 1. S·ª≠a form t·∫°o ph√≤ng v·ªõi ·∫£nh: fetch POST v·ªÅ /api/phong
        // (Ch·ªâ c·∫ßn s·ª≠a d√≤ng fetch)
        document.getElementById('createWithImageForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const donViId = document.getElementById('donVi2').value;
            const idTang = document.getElementById('idTang2').value;
            const formData = new FormData();
            formData.append('tenPhong', document.getElementById('tenPhong2').value);
            formData.append('idDvi', parseInt(donViId));
            formData.append('idTang', parseInt(idTang));
            formData.append('idLoaiPhong', document.getElementById('idLoaiPhong2').value);
            formData.append('trangThai', document.getElementById('trangThai2').value);
            const fileInput = document.getElementById('file');
            if (fileInput.files.length > 0) {
                formData.append('file', fileInput.files[0]);
            }
            fetch(API_BASE, { // S·ª≠a endpoint n√†y
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                showResult('createWithImageResult', 'Th√†nh c√¥ng!', data, 'success');
                document.getElementById('createWithImageForm').reset();
                document.getElementById('donVi2').value = '';
                document.getElementById('idTang2').innerHTML = '<option value="">-- Ch·ªçn t·∫ßng --</option>';
                document.getElementById('idLoaiPhong2').value = '1';
                document.getElementById('preview').style.display = 'none';
            })
            .catch(error => showResult('createWithImageResult', 'L·ªói!', error.message, 'error'));
        });

        // 3. Xem ph√≤ng
        function getAllPhong() {
            fetch(API_BASE)
            .then(response => response.json())
            .then(data => showResult('viewResult', 'Danh s√°ch ph√≤ng:', data, 'success'))
            .catch(error => showResult('viewResult', 'L·ªói!', error.message, 'error'));
        }

        function getAllPhongDetail() {
            fetch(API_BASE + '/detail')
            .then(response => response.json())
            .then(data => showResult('viewResult', 'Chi ti·∫øt ph√≤ng:', data, 'success'))
            .catch(error => showResult('viewResult', 'L·ªói!', error.message, 'error'));
        }

        function getPhongById() {
            const id = document.getElementById('getById').value;
            fetch(API_BASE + '/' + id)
            .then(response => response.json())
            .then(data => showResult('viewResult', 'Th√¥ng tin ph√≤ng:', data, 'success'))
            .catch(error => showResult('viewResult', 'L·ªói!', error.message, 'error'));
        }

        function getPhongDetailById() {
            const id = document.getElementById('getById').value;
            fetch(API_BASE + '/' + id + '/detail')
            .then(response => response.json())
            .then(data => showResult('viewResult', 'Chi ti·∫øt ph√≤ng:', data, 'success'))
            .catch(error => showResult('viewResult', 'L·ªói!', error.message, 'error'));
        }

        // 4. C·∫≠p nh·∫≠t ph√≤ng
        document.getElementById('updateForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const id = document.getElementById('updateId').value;
            const donViId = document.getElementById('updateDonVi').value;
            const idTang = document.getElementById('updateIdTang').value;
            const data = {
                tenPhong: document.getElementById('updateTenPhong').value,
                idTang: idTang ? parseInt(idTang) : null,
                idLoaiPhong: parseInt(document.getElementById('updateIdLoaiPhong').value),
                idDvi: donViId ? parseInt(donViId) : null,
                anhPhong: document.getElementById('updateAnhPhong').value,
                trangThai: document.getElementById('updateTrangThai').value
            };
            fetch(API_BASE + '/' + id, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(data => {
                showResult('updateResult', 'C·∫≠p nh·∫≠t th√†nh c√¥ng!', data, 'success');
                document.getElementById('updateForm').reset();
                document.getElementById('updateId').value = '1';
                document.getElementById('updateDonVi').value = '';
                document.getElementById('updateIdTang').innerHTML = '<option value="">-- Ch·ªçn t·∫ßng --</option>';
                document.getElementById('updateIdLoaiPhong').value = '1';
            })
            .catch(error => showResult('updateResult', 'L·ªói!', error.message, 'error'));
        });

        // 5. X√≥a ph√≤ng
        function deletePhong() {
            const id = document.getElementById('deleteId').value;
            
            fetch(API_BASE + '/' + id, {
                method: 'DELETE'
            })
            .then(response => {
                if (response.ok) {
                    showResult('deleteResult', 'X√≥a th√†nh c√¥ng!', 'Ph√≤ng ID ' + id + ' ƒë√£ ƒë∆∞·ª£c x√≥a', 'success');
                } else {
                    throw new Error('Kh√¥ng th·ªÉ x√≥a ph√≤ng');
                }
            })
            .catch(error => showResult('deleteResult', 'L·ªói!', error.message, 'error'));
        }

        // 6. T√¨m ki·∫øm
        function searchByTen() {
            const tenPhong = document.getElementById('searchTen').value;
            fetch(API_BASE + '/search/ten?tenPhong=' + encodeURIComponent(tenPhong))
            .then(response => response.json())
            .then(data => showResult('searchResult', 'K·∫øt qu·∫£ t√¨m ki·∫øm:', data, 'success'))
            .catch(error => showResult('searchResult', 'L·ªói!', error.message, 'error'));
        }

        function searchByKeyword() {
            const keyword = document.getElementById('searchKeyword').value;
            fetch(API_BASE + '/search/keyword?keyword=' + encodeURIComponent(keyword))
            .then(response => response.json())
            .then(data => showResult('searchResult', 'K·∫øt qu·∫£ t√¨m ki·∫øm:', data, 'success'))
            .catch(error => showResult('searchResult', 'L·ªói!', error.message, 'error'));
        }

        function searchByTrangThai() {
            const trangThai = document.getElementById('searchTrangThai').value;
            fetch(API_BASE + '/search/trangthai?trangThai=' + encodeURIComponent(trangThai))
            .then(response => response.json())
            .then(data => showResult('searchResult', 'K·∫øt qu·∫£ t√¨m ki·∫øm:', data, 'success'))
            .catch(error => showResult('searchResult', 'L·ªói!', error.message, 'error'));
        }

        // 7. L·ªçc theo tr·∫°ng th√°i
        function getAvailableRooms() {
            fetch(API_BASE + '/available')
            .then(response => response.json())
            .then(data => showResult('searchResult', 'Ph√≤ng tr·ªëng:', data, 'success'))
            .catch(error => showResult('searchResult', 'L·ªói!', error.message, 'error'));
        }

        function getBookedRooms() {
            fetch(API_BASE + '/booked')
            .then(response => response.json())
            .then(data => showResult('searchResult', 'Ph√≤ng ƒë√£ ƒë·∫∑t:', data, 'success'))
            .catch(error => showResult('searchResult', 'L·ªói!', error.message, 'error'));
        }

        function getOccupiedRooms() {
            fetch(API_BASE + '/occupied')
            .then(response => response.json())
            .then(data => showResult('searchResult', 'Ph√≤ng ƒëang s·ª≠ d·ª•ng:', data, 'success'))
            .catch(error => showResult('searchResult', 'L·ªói!', error.message, 'error'));
        }

        function getMaintenanceRooms() {
            fetch(API_BASE + '/maintenance')
            .then(response => response.json())
            .then(data => showResult('searchResult', 'Ph√≤ng b·∫£o tr√¨:', data, 'success'))
            .catch(error => showResult('searchResult', 'L·ªói!', error.message, 'error'));
        }

        // 8. Th·ªëng k√™
        function countAllPhong() {
            fetch(API_BASE + '/count')
            .then(response => response.json())
            .then(data => showResult('searchResult', 'T·ªïng s·ªë ph√≤ng:', data, 'success'))
            .catch(error => showResult('searchResult', 'L·ªói!', error.message, 'error'));
        }

        function countByTrangThai() {
            const trangThai = document.getElementById('searchTrangThai').value;
            fetch(API_BASE + '/count/trangthai?trangThai=' + encodeURIComponent(trangThai))
            .then(response => response.json())
            .then(data => showResult('searchResult', 'S·ªë ph√≤ng ' + trangThai + ':', data, 'success'))
            .catch(error => showResult('searchResult', 'L·ªói!', error.message, 'error'));
        }

        // 9. Upload ·∫£nh
        document.getElementById('uploadImageForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const id = document.getElementById('uploadPhongId').value;
            const formData = new FormData();
            formData.append('file', document.getElementById('uploadFile').files[0]);
            
            fetch(API_BASE + '/' + id + '/upload-image', {
                method: 'POST',
                body: formData
            })
            .then(response => response.text())
            .then(data => {
                showResult('uploadResult', 'Upload th√†nh c√¥ng!', data, 'success');
                document.getElementById('uploadImageForm').reset();
                document.getElementById('uploadPreview').style.display = 'none';
            })
            .catch(error => showResult('uploadResult', 'L·ªói!', error.message, 'error'));
        });

        // Helper function to show results
        function showResult(elementId, title, data, type) {
            const resultDiv = document.getElementById(elementId);
            resultDiv.innerHTML = `
                <h3>${title}</h3>
                <pre>${typeof data === 'object' ? JSON.stringify(data, null, 2) : data}</pre>
            `;
            resultDiv.className = 'result ' + type;
            resultDiv.style.display = 'block';
        }
    </script>
</body>
</html>
